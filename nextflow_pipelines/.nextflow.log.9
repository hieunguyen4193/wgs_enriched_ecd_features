Nov-23 00:42:12.334 [main] DEBUG nextflow.cli.Launcher - $> nextflow run main.nf --SAMPLE_SHEET SampleSheet_BAM_highdepth.csv --INPUT_BED /mnt/nvme/DATA_HIEUNGUYEN/resource/assets/TSS_UTR5p_regions/04_output/Normal/TSS_beds/Breast/v0.1/down_genes/promoter_regions_up_1000_down_1000.bed --OUTDIR /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/down_genes_v0.1_Breast_TSS_beds_Normal --E01_SH ../E01_generate_filter_BAM_files.sh --E02_SH ../E02_generate_enriched_ecd_wgs_features.sh --E03_SH ../E03_generate_TSS_count_features_at_enriched_regions.sh --PATH_TO_FA /mnt/nvme/DATA_HIEUNGUYEN/resource/hg19.fa --PANDEPTH /mnt/nvme/DATA_HIEUNGUYEN/resource/PanDepth/bin/pandepth --feature_srcdir ./ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0 -resume -c default.config -w /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir -with-report /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/down_genes_v0.1_Breast_TSS_beds_Normal/report.html -with-timeline /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/down_genes_v0.1_Breast_TSS_beds_Normal/timeline.html -with-dag /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/down_genes_v0.1_Breast_TSS_beds_Normal/dag.svg
Nov-23 00:42:12.426 [main] DEBUG nextflow.cli.CmdRun - N E X T F L O W  ~  version 25.04.2
Nov-23 00:42:12.445 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; embedded=false; plugins-dir=/home/hieunguyen/.nextflow/plugins; core-plugins: nf-amazon@2.15.0,nf-azure@1.16.0,nf-cloudcache@0.4.3,nf-codecommit@0.2.3,nf-console@1.2.1,nf-google@1.21.0,nf-k8s@1.0.0,nf-tower@1.11.2,nf-wave@1.12.1
Nov-23 00:42:12.472 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
Nov-23 00:42:12.473 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
Nov-23 00:42:12.475 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.12.0 in 'deployment' mode
Nov-23 00:42:12.485 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
Nov-23 00:42:12.504 [main] DEBUG nextflow.config.ConfigBuilder - User config file: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/default.config
Nov-23 00:42:12.505 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/default.config
Nov-23 00:42:12.531 [main] DEBUG n.secret.LocalSecretsProvider - Secrets store: /home/hieunguyen/.nextflow/secrets/store.json
Nov-23 00:42:12.535 [main] DEBUG nextflow.secret.SecretsLoader - Discovered secrets providers: [nextflow.secret.LocalSecretsProvider@5d1e09bc] - activable => nextflow.secret.LocalSecretsProvider@5d1e09bc
Nov-23 00:42:12.545 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `standard`
Nov-23 00:42:13.003 [main] DEBUG nextflow.cli.CmdRun - Applied DSL=2 from script declaration
Nov-23 00:42:13.016 [main] DEBUG nextflow.cli.CmdRun - Launching `main.nf` [kickass_nobel] DSL2 - revision: d0f2553ed0
Nov-23 00:42:13.017 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[]
Nov-23 00:42:13.017 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins resolved requirement=[]
Nov-23 00:42:13.057 [main] DEBUG nextflow.Session - Session UUID: e8bd47af-0c56-4ee8-aab6-501905df4da0
Nov-23 00:42:13.057 [main] DEBUG nextflow.Session - Run name: kickass_nobel
Nov-23 00:42:13.057 [main] DEBUG nextflow.Session - Executor pool size: 512
Nov-23 00:42:13.065 [main] DEBUG nextflow.file.FilePorter - File porter settings maxRetries=3; maxTransfers=50; pollTimeout=null
Nov-23 00:42:13.069 [main] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'FileTransfer' minSize=10; maxSize=1536; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Nov-23 00:42:13.160 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 25.04.2 build 5947
  Created: 13-05-2025 21:58 UTC (14-05-2025 04:58 ICST)
  System: Linux 6.12.0-103.40.4.2.el9uek.x86_64
  Runtime: Groovy 4.0.26 on OpenJDK 64-Bit Server VM 21.0.6+9-b895.97
  Encoding: UTF-8 (UTF-8)
  Process: 1585564@r02.cluster [192.168.20.12]
  CPUs: 512 - Mem: 1.5 TB (20.1 GB) - Swap: 0 (0)
Nov-23 00:42:13.194 [main] DEBUG nextflow.Session - Work-dir: /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir [xfs]
Nov-23 00:42:13.194 [main] DEBUG nextflow.Session - Script base path does not exist or is not a directory: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/bin
Nov-23 00:42:13.204 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[]
Nov-23 00:42:13.213 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
Nov-23 00:42:13.234 [main] DEBUG nextflow.Session - Observer factory (v2): LinObserverFactory
Nov-23 00:42:13.253 [main] DEBUG nextflow.cache.CacheFactory - Using Nextflow cache factory: nextflow.cache.DefaultCacheFactory
Nov-23 00:42:13.260 [main] DEBUG nextflow.util.CustomThreadPool - Creating default thread pool > poolSize: 513; maxThreads: 1000
Nov-23 00:42:13.317 [main] DEBUG nextflow.Session - Session start
Nov-23 00:42:13.483 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Nov-23 00:42:13.965 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:filterBAM_by_inputBed` matches process nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed
Nov-23 00:42:13.967 [main] WARN  nextflow.script.ProcessConfig - Unknown directive `params` for process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed`
Nov-23 00:42:13.979 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Nov-23 00:42:13.979 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Nov-23 00:42:13.985 [main] DEBUG nextflow.executor.Executor - [warm up] executor > local
Nov-23 00:42:13.991 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=512; memory=1.5 TB; capacity=512; pollInterval=100ms; dumpInterval=5m
Nov-23 00:42:13.993 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: local)
Nov-23 00:42:14.014 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed': maxForks=10; fair=false; array=0
Nov-23 00:42:14.042 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:generate_enriched_ecd_wgs_features` matches process nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features
Nov-23 00:42:14.042 [main] WARN  nextflow.script.ProcessConfig - Unknown directive `params` for process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features`
Nov-23 00:42:14.045 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Nov-23 00:42:14.045 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Nov-23 00:42:14.047 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features': maxForks=10; fair=false; array=0
Nov-23 00:42:14.052 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:generate_enriched_TSS_count_features` matches process nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features
Nov-23 00:42:14.053 [main] WARN  nextflow.script.ProcessConfig - Unknown directive `params` for process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features`
Nov-23 00:42:14.055 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Nov-23 00:42:14.055 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Nov-23 00:42:14.056 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features': maxForks=10; fair=false; array=0
Nov-23 00:42:14.059 [main] DEBUG nextflow.Session - Workflow process names [dsl2]: filterBAM_by_inputBed, nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features, nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed, nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features, generate_enriched_ecd_wgs_features, generate_enriched_TSS_count_features
Nov-23 00:42:14.061 [main] DEBUG nextflow.Session - Igniting dataflow network (4)
Nov-23 00:42:14.066 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed
Nov-23 00:42:14.067 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features
Nov-23 00:42:14.067 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features
Nov-23 00:42:14.068 [main] DEBUG nextflow.script.ScriptRunner - Parsed script files:
  Script_b5ab2f57925e4655: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/modules/generate_enriched_ecd_wgs_features.nf
  Script_9bef57911431d98d: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/modules/generate_enriched_TSS_count_features.nf
  Script_6b69257770e17a92: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/subworkflows/pipeline_init.nf
  Script_5f194485a01677f9: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/workflows/nf01_enriched_features_and_TSS_count_features.nf
  Script_e0bccd5a6949f555: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/main.nf
  Script_4042d1b501424930: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/subworkflows/run_enriched_features_and_TSS_count_features.nf
  Script_3829d38b3726548e: /home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/modules/filterBAM_by_inputBed.nf
Nov-23 00:42:14.068 [main] DEBUG nextflow.script.ScriptRunner - > Awaiting termination 
Nov-23 00:42:14.068 [main] DEBUG nextflow.Session - Session await
Nov-23 00:42:21.494 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Nov-23 00:42:21.496 [Task submitter] INFO  nextflow.Session - [1d/de8a12] Submitted process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed (ZKI75A1HD)
Nov-23 00:43:42.106 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 2; name: nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed (ZKI75A1HD); status: COMPLETED; exit: 0; error: -; workDir: /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/1d/de8a1230921f0d4ecbe891b401c1d3]
Nov-23 00:43:42.110 [Task monitor] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'TaskFinalizer' minSize=10; maxSize=1536; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Nov-23 00:43:42.177 [TaskFinalizer-1] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'PublishDir' minSize=10; maxSize=1536; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Nov-23 00:43:42.209 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Nov-23 00:43:42.210 [Task submitter] INFO  nextflow.Session - [69/c28983] Submitted process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features (ZKI75A1HD)
Nov-23 00:43:42.223 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Nov-23 00:43:42.224 [Task submitter] INFO  nextflow.Session - [19/c9d325] Submitted process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)
Nov-23 00:43:44.143 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 43; name: nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features (ZKI75A1HD); status: COMPLETED; exit: 0; error: -; workDir: /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/69/c2898354bc9f5b9dfda0787bcfc17d]
Nov-23 00:43:45.026 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 42; name: nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD); status: COMPLETED; exit: 1; error: -; workDir: /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/19/c9d325133916a12b5bd213c9d3fa54]
Nov-23 00:43:45.032 [TaskFinalizer-3] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD); work-dir=/mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/19/c9d325133916a12b5bd213c9d3fa54
  error [nextflow.exception.ProcessFailedException]: Process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)` terminated with an error exit status (1)
Nov-23 00:43:45.040 [TaskFinalizer-3] INFO  nextflow.processor.TaskProcessor - [19/c9d325] NOTE: Process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)` terminated with an error exit status (1) -- Execution is retried (1)
Nov-23 00:43:45.054 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Nov-23 00:43:45.055 [Task submitter] INFO  nextflow.Session - [77/9281fa] Re-submitted process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)
Nov-23 00:43:47.718 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 44; name: nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD); status: COMPLETED; exit: 1; error: -; workDir: /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/77/9281fa41dc54e3cd47a2972806207b]
Nov-23 00:43:47.721 [TaskFinalizer-4] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD); work-dir=/mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/77/9281fa41dc54e3cd47a2972806207b
  error [nextflow.exception.ProcessFailedException]: Process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)` terminated with an error exit status (1)
Nov-23 00:43:47.722 [TaskFinalizer-4] INFO  nextflow.processor.TaskProcessor - [77/9281fa] NOTE: Process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)` terminated with an error exit status (1) -- Execution is retried (2)
Nov-23 00:43:47.734 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Nov-23 00:43:47.735 [Task submitter] INFO  nextflow.Session - [43/ef375e] Re-submitted process > nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)
Nov-23 00:43:50.362 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 45; name: nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD); status: COMPLETED; exit: 1; error: -; workDir: /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/43/ef375ed7bc3628bcb2fb3ebda53805]
Nov-23 00:43:50.364 [TaskFinalizer-5] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD); work-dir=/mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/43/ef375ed7bc3628bcb2fb3ebda53805
  error [nextflow.exception.ProcessFailedException]: Process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)` terminated with an error exit status (1)
Nov-23 00:43:50.380 [TaskFinalizer-5] ERROR nextflow.processor.TaskProcessor - Error executing process > 'nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)'

Caused by:
  Process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)` terminated with an error exit status (1)


Command executed:

  bash E02_generate_enriched_ecd_wgs_features.sh -i 2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam -o . -f /mnt/nvme/DATA_HIEUNGUYEN/resource/hg19.fa -s ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0

Command exit status:
  1

Command output:
  WORKING ON BAM FILE  2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam  with bed file 
  input bam file:  2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam
  Pre-processing the input BAM file  2-ZKI75A1HD_S7528-S7728  ...
  Converting the input BAM file to FRAG files ...
  Splitting the input BAM file into short and long fragments ...
  Cleaning up intermediate files...
  -------------------------------------------------------------------------
  Generating features from fragment file  ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.frag.tsv  ...
  -------------------------------------------------------------------------
  getting 4bp end motif
  generating nucleosome features ...
  sorting forward nucleosome file
  sorting reverse nucleosome file
  Merge all intermediate files into one single tsv output file
  Invalid value for boolean flag: . Use 'true' or 'false' only.
  Generating final feature files ...
  ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.frag_output.tsv
  ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/fragmentomics_features
  reading in the input frag.tsv data

Command error:
  ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/02_calculate_features_from_frag.sh: line 102: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/forward_nuc.tmp.txt: Not a directory
  cat: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.forward_Nucleosome.dist.sorted.bed: Not a directory
  ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/02_calculate_features_from_frag.sh: line 105: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/reverse_nuc.tmp.txt: Not a directory
  cat: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.reverse_Nucleosome.dist.sorted.bed: Not a directory
  ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/02_calculate_features_from_frag.sh: line 108: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/forward_4bpEM.tmp.txt: Not a directory
  cat: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.forward_endmotif4bp.sorted.txt: Not a directory
  ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/02_calculate_features_from_frag.sh: line 111: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/reverse_4bpEM.tmp.txt: Not a directory
  cat: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.reverse_endmotif4bp.sorted.txt: Not a directory
  ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/02_calculate_features_from_frag.sh: line 113: ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.frag_output.tsv: Not a directory
  Invalid value for boolean flag: . Use 'true' or 'false' only.
  Generating final feature files ...
  ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.frag_output.tsv
  ./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/fragmentomics_features
  mkdir: cannot create directory ‘./2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam’: Not a directory
  reading in the input frag.tsv data
  Traceback (most recent call last):
    File "ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/04_generate_features_fragmentomics_and_image_features.py", line 28, in <module>
      main()
      ~~~~^^
    File "ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/04_generate_features_fragmentomics_and_image_features.py", line 18, in main
      output_obj = WGS_GW_Image_features(
          input_tsv = input_tsv,
          outputdir = outputdir)
    File "/home/hieunguyen/src/wgs_enriched_ecd_features/nextflow_pipelines/ecd_wgs_feature_pipeline-ecd_wgs_pipeline_v1.0/feature_class.py", line 26, in __init__
      self.maindf = pd.read_csv(input_tsv, sep = "\t", header = None)
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/hieunguyen/miniconda3/envs/nextflow_dev/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
      return _read(filepath_or_buffer, kwds)
    File "/home/hieunguyen/miniconda3/envs/nextflow_dev/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 620, in _read
      parser = TextFileReader(filepath_or_buffer, **kwds)
    File "/home/hieunguyen/miniconda3/envs/nextflow_dev/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
      self._engine = self._make_engine(f, self.engine)
                     ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
    File "/home/hieunguyen/miniconda3/envs/nextflow_dev/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
      self.handles = get_handle(
                     ~~~~~~~~~~^
          f,
          ^^
      ...<6 lines>...
          storage_options=self.options.get("storage_options", None),
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      )
      ^
    File "/home/hieunguyen/miniconda3/envs/nextflow_dev/lib/python3.13/site-packages/pandas/io/common.py", line 873, in get_handle
      handle = open(
          handle,
      ...<3 lines>...
          newline="",
      )
  NotADirectoryError: [Errno 20] Not a directory: './2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam/2-ZKI75A1HD_S7528-S7728.sorted.filtered.bam.frag_output.tsv'

Work dir:
  /mnt/nvme/DATA_HIEUNGUYEN/outdir/TOO_enriched_features/workdir/43/ef375ed7bc3628bcb2fb3ebda53805

Tip: you can replicate the issue by changing to the process work dir and entering the command `bash .command.run`
Nov-23 00:43:50.385 [TaskFinalizer-5] DEBUG nextflow.Session - Session aborted -- Cause: Process `nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features (ZKI75A1HD)` terminated with an error exit status (1)
Nov-23 00:43:50.397 [TaskFinalizer-5] DEBUG nextflow.Session - The following nodes are still active:
[process] nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed
  status=ACTIVE
  port 0: (queue) closed; channel: -
  port 1: (value) bound ; channel: inputbed
  port 2: (value) bound ; channel: inputSH
  port 3: (cntrl) -     ; channel: $

[process] nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_ecd_wgs_features
  status=ACTIVE
  port 0: (queue) OPEN  ; channel: -
  port 1: (value) bound ; channel: inputSH
  port 2: (value) bound ; channel: path_to_fa
  port 3: (value) bound ; channel: feature_srcdir
  port 4: (cntrl) -     ; channel: $

[process] nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:generate_enriched_TSS_count_features
  status=ACTIVE
  port 0: (queue) OPEN  ; channel: -
  port 1: (value) bound ; channel: inputSH
  port 2: (value) bound ; channel: inputbed
  port 3: (value) bound ; channel: pandepth
  port 4: (cntrl) -     ; channel: $

Nov-23 00:43:50.400 [main] DEBUG nextflow.Session - Session await > all processes finished
Nov-23 00:43:50.401 [main] DEBUG nextflow.Session - Session await > all barriers passed
Nov-23 00:43:50.401 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: local) - terminating tasks monitor poll loop
Nov-23 00:43:50.407 [Actor Thread 8] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=nf01_enriched_features_and_TSS_count_features:run_enriched_features_and_TSS_count_features:filterBAM_by_inputBed; work-dir=null
  error [java.lang.InterruptedException]: java.lang.InterruptedException
Nov-23 00:43:50.410 [main] DEBUG n.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=2; failedCount=3; ignoredCount=0; cachedCount=0; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=2; abortedCount=0; succeedDuration=13m 44s; failedDuration=1m 19s; cachedDuration=0ms;loadCpus=0; loadMemory=0; peakRunning=2; peakCpus=20; peakMemory=270 GB; ]
Nov-23 00:43:50.410 [main] DEBUG nextflow.trace.ReportObserver - Workflow completed -- rendering execution report
Nov-23 00:43:50.891 [main] DEBUG nextflow.trace.TimelineObserver - Workflow completed -- rendering execution timeline
Nov-23 00:43:50.981 [main] DEBUG nextflow.cache.CacheDB - Closing CacheDB done
Nov-23 00:43:50.994 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
